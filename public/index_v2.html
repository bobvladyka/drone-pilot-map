<!DOCTYPE html>
<html lang="cs">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- =====================
       PRIMARY SEO TAGS
  ====================== -->
  <title>Najdi pilota dronu v ƒåesku | Dronov√° mapa pilot≈Ø ‚Äì NajdiPilota.cz</title>
  <meta name="description" content="Hled√°te pilota dronu? Najdƒõte ovƒõ≈ôen√© piloty v cel√© ƒåR podle regionu a specializace: nat√°ƒçen√≠, inspekce, mapov√°n√≠, fotogrammetrie. P≈ôidejte se na NajdiPilota.cz." />
  <meta name="robots" content="index, follow" />
  <link rel="canonical" href="https://www.najdipilota.cz/" />
  <link rel="sitemap" type="application/xml" href="/sitemap.xml" />
  <link rel="alternate" href="https://www.najdipilota.cz/index.html" hreflang="cs" />
  <link rel="alternate" href="https://www.najdipilota.cz/index_en.html" hreflang="en" />
  <link rel="alternate" href="https://www.najdipilota.cz/" hreflang="x-default" />

  <!-- =====================
       OPEN GRAPH / SOCIAL
  ====================== -->
  <meta property="og:title" content="Najdi pilota dronu v ƒåesku ‚Äì Dronov√° mapa pilot≈Ø" />
  <meta property="og:description" content="Spojujeme z√°kazn√≠ky s ovƒõ≈ôen√Ωmi piloty dron≈Ø po cel√© ƒåR. Vyhledejte pilota podle regionu a specializace nebo se p≈ôidejte do komunity." />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://www.najdipilota.cz/" />
  <meta property="og:image" content="/icons/og-image.jpg" />
  <meta property="og:locale" content="cs_CZ" />
  <meta name="twitter:card" content="summary_large_image" />

  <!-- =====================
       VERIFICATION
  ====================== -->
  <meta name="google-site-verification" content="yxzi02d6ahPBVtx31lx_Mwg07khOFlY_fWUFdkyrsUE" />

  <!-- =====================
       STYLES
  ====================== -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster/dist/MarkerCluster.css" />
  <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster/dist/MarkerCluster.Default.css" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet" />
  <link rel="stylesheet" href="/style.css" />

  <!-- =====================
       FAVICONS
  ====================== -->
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-touch-icon.png">
  <link rel="manifest" href="/icons/site.webmanifest">
  <link rel="icon" href="/icons/favicon.ico" type="image/x-icon">

  <!-- =====================
       STRUCTURED DATA
  ====================== -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "Organization",
    "name": "NajdiPilota.cz",
    "url": "https://www.najdipilota.cz/",
    "logo": "https://www.najdipilota.cz/icons/logo.png",
    "email": "mailto:dronadmin@seznam.cz",
    "sameAs": [
      "https://www.facebook.com/",
      "https://www.instagram.com/",
      "https://www.linkedin.com/"
    ]
  }
  </script>
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebSite",
    "name": "NajdiPilota.cz",
    "url": "https://www.najdipilota.cz/",
    "potentialAction": {
      "@type": "SearchAction",
      "target": "https://www.najdipilota.cz/?q={search_term_string}",
      "query-input": "required name=search_term_string"
    }
  }
  </script>
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "FAQPage",
    "mainEntity": [
      {
        "@type": "Question",
        "name": "Jak najdu pilota dronu ve sv√©m okol√≠?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "Otev≈ôete mapu, zadejte lokalitu nebo kliknƒõte na znaƒçku v regionu. N√°slednƒõ kontaktujte pilota p≈ô√≠mo z profilu."
        }
      },
      {
        "@type": "Question",
        "name": "Kolik stoj√≠ slu≈æby pilota dronu?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "Cena z√°vis√≠ na typu zak√°zky (nat√°ƒçen√≠, inspekce, mapov√°n√≠) a regionu. Domluvte se p≈ô√≠mo s pilotem."
        }
      },
      {
        "@type": "Question",
        "name": "Mohu se jako pilot p≈ôidat na mapu?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "Ano, registrujte se, vypl≈àte profil a po ovƒõ≈ôen√≠ se zobraz√≠te na mapƒõ."
        }
      }
    ]
  }
  </script>

  <!-- =====================
       ANALYTICS
  ====================== -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-3KQTXQ496Y"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);} 
    gtag('js', new Date());
    gtag('config', 'G-3KQTXQ496Y');
  </script>
</head>
<body>
  <!-- =====================
       NAVIGATION
  ====================== -->
  <nav class="navbar navbar-expand-lg navbar-light bg-light border-bottom" aria-label="Hlavn√≠ navigace">
    <div class="container">
      <a class="navbar-brand fw-bold d-flex align-items-center" href="/index.html">
        <img src="/icons/logo.png" alt="Logo NajdiPilota.cz" height="60" class="me-2" loading="lazy" />
        <span class="fs-4">NajdiPilota.cz</span>
      </a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#mainNavbar" aria-controls="mainNavbar" aria-expanded="false" aria-label="P≈ôepnout navigaci">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="mainNavbar">
        <ul class="navbar-nav ms-auto mb-2 mb-lg-0">
          <li class="nav-item" id="inzerent-nav-item" style="display:none;">
            <a class="nav-link text-warning fw-bold" href="#" data-bs-toggle="modal" data-bs-target="#inzerentModal">
              <i class="bi bi-megaphone-fill me-1" aria-hidden="true"></i>Pro inzerenty
            </a>
          </li>
          <li class="nav-item"><a class="nav-link" href="/index.html">Mapa</a></li>
          <li class="nav-item" id="messages-nav-item" style="display:none;"><a class="nav-link" href="/moje-zpravy.html"><i class="bi bi-envelope me-1" aria-hidden="true"></i>Moje zpr√°vy</a></li>
          <li class="nav-item" id="poptavky-nav-item" style="display:none;"><a class="nav-link" href="/poptavky.html"><i class="bi bi-briefcase-fill me-1" aria-hidden="true"></i>Popt√°vky</a></li>
          <li class="nav-item"><a class="nav-link" href="/o-projektu.html">O projektu</a></li>
          <li class="nav-item"><a class="nav-link" href="/kontakt.html">Kontakt</a></li>
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#" id="langDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">üåê Jazyk</a>
            <ul class="dropdown-menu" aria-labelledby="langDropdown">
              <li><a class="dropdown-item" href="/index.html">ƒåe≈°tina</a></li>
              <li><a class="dropdown-item" href="/index_en.html">Angliƒçtina</a></li>
            </ul>
          </li>
        </ul>
        <button id="login-button" class="pilot-login-btn btn-sm user-action d-flex align-items-center justify-content-center px-3 py-2" aria-haspopup="dialog">
          <i class="bi bi-person-badge me-2" aria-hidden="true"></i>
          <span id="login-toggle">P≈ôihl√°sit se jako pilot</span>
        </button>
      </div>
    </div>
  </nav>

  <!-- =====================
       HERO / INTRO
  ====================== -->
  <div class="container py-4">
    <header class="text-center mb-4">
      <h1 class="mb-2"><i class="bi bi-map-fill me-2" aria-hidden="true"></i>Dronov√° mapa pilot≈Ø v ƒåesku</h1>
      <p id="user-status" class="fw-bold mb-0" aria-live="polite"></p>
    </header>

    <!-- CTA login/register (hidden for advertisers) -->
    <div id="pilot-login-wrapper" class="d-flex flex-wrap align-items-center gap-2 justify-content-center"></div>

    <!-- Inzerent Modal -->
    <div class="modal fade" id="inzerentModal" tabindex="-1" aria-labelledby="inzerentModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content border-warning">
          <div class="modal-header bg-warning">
            <h5 class="modal-title" id="inzerentModalLabel"><i class="bi bi-building me-2" aria-hidden="true"></i>Pro firmy a inzerenty</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Zav≈ô√≠t"></button>
          </div>
          <div class="modal-body">
            <p>Hled√°te pilota pro nat√°ƒçen√≠, inspekci nebo mapov√°n√≠? Vyberte si z ovƒõ≈ôen√Ωch pilot≈Ø podle regionu a specializace.</p>
          </div>
          <div class="modal-footer">
            <a href="/inzerent.html" class="btn btn-outline-warning">
              <i class="bi bi-person-badge-fill me-1" aria-hidden="true"></i> P≈ôihl√°sit se jako inzerent
            </a>
          </div>
        </div>
      </div>
    </div>

    <!-- Intro copy for SEO (visually hidden hint + readable text) -->
    <p class="visually-hidden">Interaktivn√≠ mapa ovƒõ≈ôen√Ωch pilot≈Ø dron≈Ø v ƒåR. Najdƒõte pilota podle lokality, vybaven√≠ a specializace. Rychl√© spojen√≠ bez zprost≈ôedkovatel≈Ø.</p>

    <section class="mb-5">
      <p><strong>Hled√°te pilota dronu ve sv√©m okol√≠?</strong> Nebo s√°m/sama l√©t√°te a chcete b√Ωt vidƒõt?</p>
      <p>Tato mapa propojuje z√°kazn√≠ky s piloty. Vyhledejte spolehliv√©ho pilota podle m√≠sta, vybaven√≠ nebo specializace ‚Äì anebo se zaregistrujte a z√≠skejte nov√© p≈ô√≠le≈æitosti k l√©t√°n√≠ i v√Ωdƒõlku.</p>
      <ul>
        <li><strong>Rychl√© spojen√≠</strong> bez zbyteƒçn√Ωch formul√°≈ô≈Ø</li>
        <li><strong>Ovƒõ≈ôen√≠ piloti</strong> s profilem a kontakty</li>
        <li><strong>Mo≈ænost p≈ôiv√Ωdƒõlku</strong> pro ka≈æd√©ho pilota</li>
      </ul>
      <p class="mb-0"><strong>Zaƒçnƒõte kliknut√≠m na pilota na mapƒõ nebo se p≈ôihlaste a p≈ôidejte se!</strong></p>
    </section>

    <!-- =====================
         HOW IT WORKS (SEO section)
    ====================== -->
    <section class="mb-5">
      <h2 class="h4"><i class="bi bi-lightning-charge-fill me-2" aria-hidden="true"></i>Jak funguje NajdiPilota.cz?</h2>
      <ol class="mb-3">
        <li><strong>Vyhledejte pilota</strong> podle lokality nebo specializace (inspekce, nat√°ƒçen√≠, mapov√°n√≠).</li>
        <li><strong>Otev≈ôete profil</strong> a zkontrolujte vybaven√≠, zku≈°enosti a dostupnost.</li>
        <li><strong>Kontaktujte pilota</strong> a domluvte term√≠n i cenu p≈ô√≠mo.</li>
      </ol>
      <p>Pro firmy m√°me rychlou registraci inzerenta. <a href="/inzerent.html">P≈ôihl√°sit se jako inzerent</a>.</p>
    </section>

    <!-- =====================
         USE CASES (SEO section)
    ====================== -->
    <section class="mb-5">
      <h2 class="h4"><i class="bi bi-camera-video-fill me-2" aria-hidden="true"></i>Nejƒçastƒõj≈°√≠ vyu≈æit√≠ dron≈Ø</h2>
      <div class="row g-3">
        <div class="col-md-6">
          <ul class="mb-0">
            <li>Leteck√© nat√°ƒçen√≠ a fotografie akc√≠, realit a cestovn√≠ho ruchu</li>
            <li>Inspekce st≈ôech, fas√°d a pr≈Ømyslov√Ωch are√°l≈Ø</li>
            <li>Mapov√°n√≠ a <strong>fotogrammetrie</strong> (ortomapy, 3D modely)</li>
          </ul>
        </div>
        <div class="col-md-6">
          <ul class="mb-0">
            <li>Geod√©zie a stavebnictv√≠ (monitoring stavby)</li>
            <li>Zemƒõdƒõlstv√≠ (monitoring porostu)</li>
            <li>Z√°chrann√© a bezpeƒçnostn√≠ slo≈æky (pr≈Øzkum, p√°tr√°n√≠)</li>
          </ul>
        </div>
      </div>
    </section>

    <!-- =====================
         MAP + LIST
    ====================== -->
    <section class="mb-4">
      <h2 class="h4"><i class="bi bi-geo-alt-fill text-danger me-2" aria-hidden="true"></i>Seznam pilot≈Ø na mapƒõ</h2>
      <p>Na mapƒõ n√≠≈æe vid√≠te dostupn√© piloty. Kliknƒõte na ikonu a otev≈ôete profil s vybaven√≠m, specializac√≠ a kontaktem. P≈ôihl√°≈°en√≠ u≈æivatel√© uvid√≠ roz≈°√≠≈ôen√© informace.</p>

      <div id="login-modal-backdrop" aria-hidden="true"></div>

      <!-- Login box (initially hidden) -->
      <div id="login-box" style="display: none; position: relative;" role="dialog" aria-labelledby="loginBoxTitle" aria-modal="true">
        <button type="button" class="btn-close close-btn" aria-label="Zav≈ô√≠t" onclick="document.getElementById('login-box').style.display='none';"></button>
        <h3 id="loginBoxTitle">P≈ôihl√°≈°en√≠ pilota</h3>
        <form id="login-form" onsubmit="pilotLogin(event)">
          <div class="mb-3">
            <label for="email" class="form-label">E‚Äëmail</label>
            <input type="email" id="email" name="email" class="form-control" required />
          </div>
          <div class="mb-3">
            <label for="password" class="form-label">Heslo</label>
            <input type="password" id="password" name="password" class="form-control" required />
          </div>
          <button type="submit" class="pilot-login-btn btn-sm user-action d-flex align-items-center justify-content-center px-3 py-2 w-100">
            <i class="bi bi-box-arrow-in-right me-2" aria-hidden="true"></i>P≈ôihl√°sit se
          </button>
        </form>
        <p id="login-status" class="mt-3"></p>
        <a href="/register.html" class="link">Nejsem je≈°tƒõ registrov√°n ‚Äì chci se zaregistrovat</a>
        <a href="/forgot.html" class="link">Zapomenut√© heslo?</a>
      </div>

      <div id="map" class="mt-4" role="region" aria-label="Mapa pilot≈Ø" style="min-height: 520px;"></div>
      <noscript>
        <div class="alert alert-info mt-3" role="status">Pro zobrazen√≠ interaktivn√≠ mapy povolte JavaScript. Mezit√≠m m≈Ø≈æete kontaktovat inzerci na <a href="/kontakt.html">/kontakt.html</a> nebo p≈ôej√≠t na <a href="/poptavky.html">/poptavky.html</a>.</div>
      </noscript>
    </section>

    <!-- =====================
         CITY SHORTCUTS (Internal links)
    ====================== -->
    <section class="mb-5">
      <h2 class="h5"><i class="bi bi-geo me-2" aria-hidden="true"></i>Rychl√© odkazy podle mƒõsta</h2>
      <p class="mb-1">Hled√°te pilota v konkr√©tn√≠ lokalitƒõ? Zkuste:</p>
      <p class="mb-0">
        <a href="/index.html?q=Praha">Praha</a> ¬∑
        <a href="/index.html?q=Brno">Brno</a> ¬∑
        <a href="/index.html?q=Ostrava">Ostrava</a> ¬∑
        <a href="/index.html?q=Plze≈à">Plze≈à</a> ¬∑
        <a href="/index.html?q=Liberec">Liberec</a>
      </p>
    </section>

    <!-- =====================
         FAQ (visible content aligns with JSON-LD)
    ====================== -->
    <section class="mb-5">
      <h2 class="h4"><i class="bi bi-question-circle-fill me-2" aria-hidden="true"></i>ƒåast√© dotazy</h2>
      <div class="accordion" id="faq">
        <div class="accordion-item">
          <h3 class="accordion-header" id="faq1h"><button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#faq1" aria-expanded="false" aria-controls="faq1">Jak najdu pilota dronu ve sv√©m okol√≠?</button></h3>
          <div id="faq1" class="accordion-collapse collapse" aria-labelledby="faq1h" data-bs-parent="#faq"><div class="accordion-body">Otev≈ôete mapu, zadejte lokalitu nebo kliknƒõte na znaƒçku v regionu. Pot√© kontaktujte pilota p≈ô√≠mo z profilu.</div></div>
        </div>
        <div class="accordion-item">
          <h3 class="accordion-header" id="faq2h"><button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#faq2" aria-expanded="false" aria-controls="faq2">Kolik stoj√≠ slu≈æby pilota dronu?</button></h3>
          <div id="faq2" class="accordion-collapse collapse" aria-labelledby="faq2h" data-bs-parent="#faq"><div class="accordion-body">Cena se li≈°√≠ dle typu zak√°zky (nat√°ƒçen√≠, inspekce, mapov√°n√≠) a regionu. Podrobnosti vy≈ôe≈°√≠te p≈ô√≠mo s pilotem.</div></div>
        </div>
        <div class="accordion-item">
          <h3 class="accordion-header" id="faq3h"><button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#faq3" aria-expanded="false" aria-controls="faq3">Mohu se jako pilot p≈ôidat na mapu?</button></h3>
          <div id="faq3" class="accordion-collapse collapse" aria-labelledby="faq3h" data-bs-parent="#faq"><div class="accordion-body">Ano, registrujte se, vypl≈àte profil a po ovƒõ≈ôen√≠ se zobraz√≠te na mapƒõ.</div></div>
        </div>
      </div>
    </section>
  </div>

  <!-- =====================
       CONTACT PILOT MODAL
  ====================== -->
  <div class="modal fade" id="contactPilotModal" tabindex="-1" aria-labelledby="contactPilotModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="contactPilotModalLabel">Napsat pilotovi</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Zav≈ô√≠t"></button>
        </div>
        <div class="modal-body">
          <div class="mb-3">
            <label for="contactMessage" class="form-label">Va≈°e zpr√°va</label>
            <textarea id="contactMessage" class="form-control" rows="5" placeholder="Napi≈°te zde svou zpr√°vu..."></textarea>
          </div>
          <input type="hidden" id="contactPilotEmail">
        </div>
        <div class="modal-footer">
          <button type="button" class="pilot-login-btn btn-sm user-action d-flex align-items-center justify-content-center px-3 py-2 w-100" data-bs-dismiss="modal">Zav≈ô√≠t</button>
          <button type="button" class="pilot-login-btn btn-sm user-action d-flex align-items-center justify-content-center px-3 py-2 w-100" id="sendContactMessage">Odeslat</button>
        </div>
      </div>
    </div>
  </div>

  <!-- =====================
       PUBLIC CONTACT CONSENT MODAL
  ====================== -->
  <div class="modal fade" id="publicContactConsentModal" tabindex="-1" aria-labelledby="publicContactConsentLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content border-warning">
        <div class="modal-header bg-warning">
          <h5 class="modal-title" id="publicContactConsentLabel">Souhlas se zve≈ôejnƒõn√≠m kontakt≈Ø</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Zav≈ô√≠t"></button>
        </div>
        <div class="modal-body">
          Souhlas√≠m, aby m≈Øj e‚Äëmail a telefon byly ve≈ôejnƒõ zobrazeny na m√©m profilu.
          <div class="form-check mt-3">
            <input class="form-check-input" type="checkbox" id="premiumConsentCheck">
            <label class="form-check-label" for="premiumConsentCheck">Souhlas√≠m se zve≈ôejnƒõn√≠m kontaktn√≠ch √∫daj≈Ø</label>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">Zru≈°it</button>
          <button type="button" class="btn btn-warning" id="confirmPremiumConsent">Potvrdit</button>
        </div>
      </div>
    </div>
  </div>

  <!-- =====================
       FOOTER
  ====================== -->
  <footer class="footer mt-5 pt-4 pb-4 bg-light border-top">
    <div class="container">
      <div class="row gy-3 justify-content-between">
        <div class="col-md-4">
          <a href="/" class="d-flex align-items-center mb-2 text-decoration-none text-dark">
            <img src="/icons/logo.png" alt="Logo NajdiPilota.cz" height="40" loading="lazy" class="me-2" />
            <span class="fw-bold fs-5">NajdiPilota.cz</span>
          </a>
          <p class="small text-muted">Spojujeme z√°kazn√≠ky s ovƒõ≈ôen√Ωmi piloty dron≈Ø po cel√© ƒåR. Rychl√© spojen√≠ bez prost≈ôedn√≠k≈Ø.</p>
        </div>
        <div class="col-md-2">
          <h6 class="fw-bold">Navigace</h6>
          <ul class="list-unstyled">
            <li><a href="/index.html" class="text-decoration-none text-muted">Mapa pilot≈Ø</a></li>
            <li><a href="/o-projektu.html" class="text-decoration-none text-muted">O projektu</a></li>
            <li><a href="/kontakt.html" class="text-decoration-none text-muted">Kontakt</a></li>
            <li><a href="/v-procesu.html" class="text-decoration-none text-muted">Blog</a></li>
          </ul>
        </div>
        <div class="col-md-3">
          <h6 class="fw-bold">Informace</h6>
          <ul class="list-unstyled">
            <li><a href="/gdpr.html" class="text-decoration-none text-muted">Zpracov√°n√≠ osobn√≠ch √∫daj≈Ø</a></li>
            <li><a href="/v-procesu.html" class="text-decoration-none text-muted">Cookies</a></li>
            <li><a href="/v-procesu.html" class="text-decoration-none text-muted">Obchodn√≠ podm√≠nky</a></li>
            <li><a href="mailto:dronadmin@seznam.cz?subject=Chyba na webu" class="text-decoration-none text-muted">Nahl√°sit chybu</a></li>
          </ul>
        </div>
        <div class="col-md-3">
          <h6 class="fw-bold">Provozovatel</h6>
          <p class="small text-muted mb-1">Ing. Bohuslav Vladyka<br>IƒåO: 08578591<br>Praha, ƒåesk√° republika</p>
          <p class="small text-muted mb-0">üìß <a href="mailto:dronadmin@seznam.cz" class="text-muted">dronadmin@seznam.cz</a></p>
        </div>
      </div>
      <hr class="my-4">
      <div class="d-flex justify-content-between align-items-center small text-muted">
        <span>&copy; <span id="year"></span> NajdiPilota.cz</span>
        <div>
          <a href="/v-procesu.html" class="text-muted me-3" aria-label="Facebook"><i class="bi bi-facebook" aria-hidden="true"></i></a>
          <a href="/v-procesu.html" class="text-muted me-3" aria-label="Instagram"><i class="bi bi-instagram" aria-hidden="true"></i></a>
          <a href="/v-procesu.html" class="text-muted" aria-label="LinkedIn"><i class="bi bi-linkedin" aria-hidden="true"></i></a>
        </div>
      </div>
    </div>
  </footer>

  <!-- =====================
       SCRIPTS
  ====================== -->
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <script src="https://unpkg.com/leaflet.markercluster/dist/leaflet.markercluster.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

  <script>
    // Init year
    document.addEventListener('DOMContentLoaded', () => {
      const yearEl = document.getElementById('year');
      if (yearEl) yearEl.textContent = new Date().getFullYear();
    });
  </script>

  <script>
    // Map init
    const map = L.map('map').setView([49.8, 15.5], 7);
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a>',
      maxZoom: 18
    }).addTo(map);

    const markers = L.markerClusterGroup();
    const pilotCircles = [];

    // Fetch pilots for map
    fetch('/pilots')
      .then(res => res.json())
      .then(data => {
        const fakeNames = [
          'Rychl√Ω Sysel','L√©taj√≠c√≠ Brambor','Dronislav Nebe≈°≈•√°k','Turbo R√°kosn√≠k','Bezpilotn√≠ Emil','P√≠skaj√≠c√≠ P√°v','Pilotka Haluz','Franti≈°ek Vrtuln√≠k','Lev√Ω Joystick','Kapit√°n St√≠n','Dr. Rotor','Pan Toƒçiv√Ω','Letu≈°ka Landov√°','St≈ôemhlav√Ω Franta','Nadzvukov√Ω Je≈æek','L√©taj√≠c√≠ ƒåenda','Rotorov√° R√≥za','≈†um√≠c√≠ Fanda','Bezpeƒçn√Ω B√©ƒèa','Maj√°k z Oblak','Dron√Ω Karel','Letec ≈†matla','Start√©r Stan√≠k','P≈ôist√°vac√≠ Pepa','Helikopt√©rn√≠k Honza','Navig√°tor Nov√°k','Senzorov√° So≈àa','P√°n Mrak≈Ø','Let√≠c√≠ Lojza','Kamera Kamil','Rotor R√≠≈°a','V√Ω≈°komƒõr Va≈°ek','Vzdu≈°n√Ω Vojta','Tich√Ω ≈†um√°k','Drnƒçiv√Ω Dan','Mlha Milda','Optika Otakar','Ztracen√Ω Sign√°l','Mistr Gimbal','Ant√©na Aniƒçka','Vrtulka Vƒõrka','Letmo L√≠da','Flyboy Felix','Vzdu≈°n√° V√≠la','Navigaƒçn√≠ Norbert','Modr√° Letka','K≈ô√≠dlat√Ω Karel','Poln√≠ P≈ô√≠zrak','Mapov√Ω Mirek','Kliƒçkuj√≠c√≠ Kuba'
        ];

        data.forEach(p => {
          if (p.visible !== 'ANO') return;
          if (p.latitude == null || p.longitude == null) return;

          const circleOptions = (() => {
            const base = {
              radius: 2000,
              fillOpacity: 0.2,
              color: p.available === 'ANO' ? 'green' : 'gray',
              fillColor: p.available === 'ANO' ? '#4CAF50' : '#CCCCCC',
              weight: 1
            };
            if (p.type_account === 'Free') {
              return { ...base, color: 'lightgreen', fillOpacity: 0.2 };
            }
            if (p.type_account === 'Basic') {
              return { ...base, color: 'darkgreen', fillOpacity: 0.5, fillColor: 'darkgreen' };
            }
            if (p.type_account === 'Premium') {
              return { ...base, color: 'purple', fillColor: 'purple', fillOpacity: 0.8, radius: 10000, weight: 3 };
            }
            return base;
          })();

          const circle = L.circle([p.latitude, p.longitude], circleOptions).bindPopup(() => {
            const loggedIn = localStorage.getItem('loggedEmail') || localStorage.getItem('inzerentEmail');
            const isAvailable = p.available === 'ANO';
            const fakeName = fakeNames[Math.floor(Math.random() * fakeNames.length)];
            const hasBuildBadge = p.id && Number(p.id) <= 80;
            const buildBadge = hasBuildBadge ? '<img src="/icons/build50_v1.png" alt="Build 50 odznak" width="64" height="64" class="ms-2 align-middle" title="Build 50">' : '';

            const hasPublicConsent = (() => {
              const v = (p.hasPublicConsent ?? p.granted ?? false);
              if (typeof v === 'boolean') return v;
              const s = String(v).trim().toLowerCase();
              return s === 'true' || s === 't' || s === '1' || s === 'ano' || s === 'yes';
            })();

            const nameSafe = (p.name || '').replace(/</g,'&lt;').replace(/>/g,'&gt;');

            // No consent ‚Üí anonymizovan√Ω profil
            if (!hasPublicConsent) {
              return `
                <div class="pilot-card">
                  <h3><i class="bi bi-person-circle me-1" aria-hidden="true"></i>${fakeName}${buildBadge}</h3>
                  <div class="d-flex flex-wrap gap-2 mb-2">
                    ${p.volunteer === 'ANO' ? '<span class="badge-volunteer">Dobrovoln√≠k</span>' : ''}
                    <span class="badge-gdpr">Bez GDPR souhlasu ‚Äì kontakt p≈ôes administr√°tora</span>
                  </div>
                  ${p.specialization ? `<p><i class='bi bi-puzzle-fill me-1'></i><strong>Specializace:</strong> ${p.specialization}</p>` : ''}
                </div>`;
            }

            let html = `<div class="pilot-card">`;
            const verified = p.registrationnumber && p.registrationnumber.startsWith('CZE') && p.registrationnumber.length === 16
              ? '<img src="/icons/approved_4.png" alt="Ovƒõ≈ôen√Ω provozovatel" width="60" class="ms-2">' : '';

            const header = `
              <div class="d-flex justify-content-between align-items-center mb-1">
                <h3 class="mb-0"><i class="bi bi-person-circle me-1" aria-hidden="true"></i>${nameSafe || fakeName}</h3>
                ${verified}
                ${buildBadge}
              </div>`;

            const common = `
              ${p.volunteer === 'ANO' ? '<div class="mb-2"><span class="badge-volunteer">Dobrovoln√≠k</span></div>' : ''}
              ${p.drones ? `<p><i class='bi bi-drone me-1'></i><strong>Drony:</strong> ${p.drones}</p>` : ''}
              ${p.specialization ? `<p><i class='bi bi-puzzle-fill me-1'></i><strong>Specializace:</strong> ${p.specialization}</p>` : ''}`;

            if (isAvailable && loggedIn) {
              if (p.type_account === 'Free') {
                html += header + common + '</div>';
              } else if (p.type_account === 'Basic') {
                html += header + `
                  ${p.note ? `<p><i class='bi bi-chat-left-text me-1'></i><strong>O mnƒõ:</strong> ${p.note}</p>` : ''}
                  ${p.travel ? `<p><i class='bi bi-signpost me-1'></i><strong>Doj√≠≈ædƒõn√≠:</strong> ${p.travel}</p>` : ''}
                  ${p.licenses ? `<p><i class='bi bi-award me-1'></i><strong>Licence:</strong> ${p.licenses}</p>` : ''}
                  ${common}
                  <div class="mt-3">
                    <button class="pilot-login-btn btn-sm user-action d-flex align-items-center justify-content-center px-3 py-2 w-100" onclick="contactPilot('${p.email}')">‚úâÔ∏è Napsat pilotovi</button>
                  </div>
                </div>`;
              } else if (p.type_account === 'Premium') {
                html += header + `
                  ${p.email ? `<p><i class='bi bi-envelope-at me-1'></i><a href='mailto:${p.email}'>${p.email}</a></p>` : ''}
                  ${p.phone ? `<p><i class='bi bi-telephone-fill me-1'></i><a href='tel:${p.phone}'>${p.phone}</a></p>` : ''}
                  ${p.travel ? `<p><i class='bi bi-signpost me-1'></i><strong>Doj√≠≈ædƒõn√≠:</strong> ${p.travel}</p>` : ''}
                  ${p.licenses ? `<p><i class='bi bi-award me-1'></i><strong>Licence:</strong> ${p.licenses}</p>` : ''}
                  ${common}
                </div>`;
              }
            } else if (!isAvailable) {
              html += `
                <h3><i class="bi bi-person-circle me-1" aria-hidden="true"></i>${fakeName}${buildBadge}</h3>
                ${p.volunteer === 'ANO' ? '<div class="mb-2"><span class="badge-volunteer">Dobrovoln√≠k</span></div>' : ''}
                <p class="text-danger"><i class="bi bi-exclamation-triangle-fill me-1" aria-hidden="true"></i>Tento pilot moment√°lnƒõ nen√≠ k dispozici</p>
                ${p.specialization ? `<p><i class='bi bi-puzzle-fill me-1'></i><strong>Specializace:</strong> ${p.specialization}</p>` : ''}
              `;
            } else {
              html += `
                <h3><i class="bi bi-person-circle me-1" aria-hidden="true"></i>${fakeName}${buildBadge}</h3>
                ${p.volunteer === 'ANO' ? '<div class="mb-2"><span class="badge-volunteer">Dobrovoln√≠k</span></div>' : ''}
                <p><i class="bi bi-envelope-at me-1" aria-hidden="true"></i><span class="text-muted">[e‚Äëmail po p≈ôihl√°≈°en√≠]</span></p>
                ${p.phone ? '<p><i class="bi bi-telephone-fill me-1" aria-hidden="true"></i><span class="text-muted">[telefon skryt]</span></p>' : ''}
                ${p.specialization ? `<p><i class='bi bi-puzzle-fill me-1'></i><strong>Specializace:</strong> ${p.specialization}</p>` : ''}
                ${p.travel ? `<p><i class='bi bi-signpost me-1'></i><strong>Doj√≠≈ædƒõn√≠:</strong> ${p.travel}</p>` : ''}
                <p class="text-muted"><em>P≈ôihlaste se jako inzerent pro v√≠ce informac√≠ o pilotovi.</em></p>
              `;
            }
            html += '</div>';
            return html;
          });

          markers.addLayer(circle);
          pilotCircles.push(circle);
        });

        map.addLayer(markers);
        if (markers.getBounds().isValid()) {
          map.fitBounds(markers.getBounds(), { padding: [30, 30] });
        }
      });

    // Responsive radius & opacity on zoom
    map.on('zoomend', () => {
      const zoom = map.getZoom();
      pilotCircles.forEach(circle => {
        const maxZoom = 14, minZoom = 7, minRadius = 100, maxRadius = 2000;
        let accountMinRadius = minRadius, accountMaxRadius = maxRadius;
        if (circle.options.fillColor === 'darkgreen') { accountMinRadius = 100; accountMaxRadius = 4000; }
        else if (circle.options.fillColor === 'purple') { accountMinRadius = 100; accountMaxRadius = 10000; }
        const ratio = (zoom - minZoom) / (maxZoom - minZoom);
        const radius = Math.max(accountMinRadius, accountMaxRadius - (accountMaxRadius - accountMinRadius) * ratio);
        circle.setRadius(radius);
        const opacity = 0.2 + 0.2 * (1 - ratio);
        circle.setStyle({ fillOpacity: opacity });
      });
    });
  </script>

  <script>
    // Auth & UI state
    document.addEventListener('DOMContentLoaded', () => {
      const loginBox = document.getElementById('login-box');
      const toggle = document.getElementById('login-toggle');
      const status = document.getElementById('user-status');
      const editBtn = document.getElementById('edit-profile-btn');
      const messagesNavItem = document.getElementById('messages-nav-item');
      const inzerentNavItem = document.getElementById('inzerent-nav-item');

      const loggedEmail = localStorage.getItem('loggedEmail');
      const inzerentEmail = localStorage.getItem('inzerentEmail');

      if (!loggedEmail && inzerentNavItem) inzerentNavItem.style.display = 'block';

      if (loggedEmail) {
        if (loginBox) loginBox.style.display = 'none';
        if (toggle) toggle.textContent = 'Odhl√°sit';
        if (status) status.textContent = 'P≈ôihl√°≈°en jako: ' + loggedEmail;
        if (messagesNavItem) messagesNavItem.style.display = 'block';

        // Show popt√°vky for Basic/Premium
        const poptavkyNavItem = document.getElementById('poptavky-nav-item');
        if (poptavkyNavItem) {
          fetch('/get-my-pilot', { credentials: 'include' })
            .then(r => r.ok ? r.json() : null)
            .then(me => {
              const t = (me?.type_account || '').toLowerCase();
              poptavkyNavItem.style.display = (t === 'basic' || t === 'premium') ? 'block' : 'none';
            })
            .catch(() => { poptavkyNavItem.style.display = 'none'; });
        }

        toggle?.addEventListener('click', () => {
          localStorage.removeItem('loggedEmail');
          window.location.reload();
        });
      } else {
        toggle?.addEventListener('click', () => {
          if (!loginBox) return;
          loginBox.style.display = loginBox.style.display === 'none' ? 'block' : 'none';
        });
      }

      // Hide pilot login area for advertisers
      const loginWrapper = document.getElementById('pilot-login-wrapper');
      if (inzerentEmail && loginWrapper) {
        loginWrapper.style.display = 'none';
      }

      // Remove inzerent session on non-inzerent pages (kept as in source)
      if (localStorage.getItem('inzerentEmail')) {
        // Commented out to avoid unexpected logout on index. Uncomment if desired.
        // localStorage.removeItem('inzerentEmail');
      }

      // Active nav link
      const currentPage = window.location.pathname;
      document.querySelectorAll('.navbar-nav .nav-item .nav-link').forEach(link => {
        if (link.getAttribute('href') === currentPage) {
          link.parentElement.classList.add('active');
        }
      });
    });

    // Login submit
    function pilotLogin(event) {
      event.preventDefault();
      const email = document.getElementById('email').value;
      const password = document.getElementById('password').value;
      const statusBox = document.getElementById('login-status');

      fetch('/login', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ email, password })
      })
        .then(res => { if (!res.ok) throw new Error('Neplatn√Ω e‚Äëmail nebo heslo.'); return res.text(); })
        .then(msg => {
          localStorage.setItem('loggedEmail', email);
          statusBox.style.color = 'green';
          statusBox.textContent = msg;
          window.location.href = '/account.html?email=' + encodeURIComponent(email);
        })
        .catch(err => {
          statusBox.style.color = 'red';
          statusBox.textContent = err.message;
        });
    }
    window.pilotLogin = pilotLogin;

    // Contact pilot
    function contactPilot(pilotEmail) {
      const currentUserEmail = localStorage.getItem('loggedEmail') || localStorage.getItem('inzerentEmail');
      const currentUserType = localStorage.getItem('loggedEmail') ? 'pilot' : 'inzerent';
      if (!currentUserEmail) {
        alert('Pro komunikaci s piloty se mus√≠te p≈ôihl√°sit.');
        return;
      }
      Promise.all([
        fetch(`/get-user-id?email=${encodeURIComponent(currentUserEmail)}&type=${currentUserType}`).then(res => res.json()),
        fetch(`/get-user-id?email=${encodeURIComponent(pilotEmail)}&type=pilot`).then(res => res.json())
      ])
        .then(([currentUser, partner]) => {
          return fetch('/create-conversation', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ pilotEmail, advertiserEmail: currentUserType === 'inzerent' ? currentUserEmail : null })
          }).then(res => res.json());
        })
        .then(({ success, conversationId }) => {
          if (!success) throw new Error('Nepoda≈ôilo se vytvo≈ôit konverzaci.');
          window.location.href = `/chat.html?conversationId=${conversationId}`;
        })
        .catch(err => {
          console.error('Chyba p≈ôi vytv√°≈ôen√≠ konverzace:', err);
          alert('Pro nav√°z√°n√≠ konverzace se p≈ôihlaste jako inzerent.');
        });
    }
    window.contactPilot = contactPilot;

    // Send contact message (modal)
    document.addEventListener('DOMContentLoaded', () => {
      const btn = document.getElementById('sendContactMessage');
      if (!btn) return;
      btn.addEventListener('click', () => {
        const pilotEmail = document.getElementById('contactPilotEmail').value;
        const message = document.getElementById('contactMessage').value.trim();
        if (!message) { alert('Pros√≠m napi≈°te zpr√°vu.'); return; }
        fetch('/contact-pilot', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ to: pilotEmail, message })
        })
          .then(res => { if (!res.ok) throw new Error('Nepoda≈ôilo se odeslat zpr√°vu.'); return res.text(); })
          .then(response => {
            alert(response);
            const modalEl = document.getElementById('contactPilotModal');
            if (modalEl) bootstrap.Modal.getInstance(modalEl)?.hide();
          })
          .catch(err => alert('‚ùå Chyba: ' + err.message));
      });
    });

    // Consent save
    document.addEventListener('DOMContentLoaded', () => {
      const btn = document.getElementById('confirmPremiumConsent');
      if (!btn) return;
      btn.addEventListener('click', function() {
        if (!document.getElementById('premiumConsentCheck').checked) {
          alert('Mus√≠te potvrdit souhlas se zve≈ôejnƒõn√≠m kontakt≈Ø.');
          return;
        }
        fetch('/save-consent', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({
            consent_type: 'public_contact',
            consent_text: 'Souhlas se zve≈ôejnƒõn√≠m e‚Äëmailu a telefonu na ve≈ôejn√©m profilu.',
            timestamp: new Date().toISOString()
          })
        })
          .then(res => { if (!res.ok) throw new Error('Nepoda≈ôilo se ulo≈æit souhlas.'); alert('Souhlas byl ulo≈æen. Va≈°e kontakty budou nyn√≠ viditeln√©.'); location.reload(); })
          .catch(err => alert(err.message));
      });
    });

    // Unread badge refresh
    async function refreshUnreadNavBadge() {
      const email = localStorage.getItem('loggedEmail');
      if (!email) return;
      try {
        const r = await fetch('/unread-count?pilotEmail=' + encodeURIComponent(email));
        const data = await r.json();
        renderUnreadBadgeIntoNav(data.count || 0);
      } catch {}
    }
    function renderUnreadBadgeIntoNav(count) {
      const li = document.getElementById('messages-nav-item');
      if (!li) return;
      const a = li.querySelector('a.nav-link');
      if (!a) return;
      let badge = a.querySelector('#unread-badge');
      if (!badge) {
        badge = document.createElement('span');
        badge.id = 'unread-badge';
        badge.className = 'badge rounded-pill bg-danger ms-2';
        a.appendChild(badge);
      }
      badge.textContent = String(count);
      badge.style.display = count > 0 ? '' : 'none';
    }
    document.addEventListener('DOMContentLoaded', () => {
      if (localStorage.getItem('loggedEmail')) {
        refreshUnreadNavBadge();
        setInterval(refreshUnreadNavBadge, 60000);
      }
    });
  </script>
</body>
</html>
